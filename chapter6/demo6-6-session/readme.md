###6-6 session (会话)

cookie的问题
1. 上一节的问题 会暴露 username，很危险
2. cookie中存储 userid， server端对应 username
3. session 即 用户端存储用户信息

###当前设置session代码的问题

session是放在 SESSION_DATA里 （变量，程序运行时的内存块）
session直接是 js变量，放在nodejs进程内存中。
1. 第一 进程内存有限，访问量过大，内存暴增怎么办？ 有限的内存中 内存会越来越大
2. 第二 正式线上运行是多进程，进程之间内存无法共享（多机器，多进程）
3. 开启服务时 每个 nodejs 是多个进程跑的 进程之间的内存是不能共享的


###解决方法
redis 
1. web server最常用的缓存数据库。 数据存放在内存中。
2. 相比于 mysql，访问数据快 （内存和 硬盘不是一个数量级的）
3. 但是成本过高， 可存储的数据量更小


将webserver 和 redis 拆分为两个单独的服务
双方都是独立的， 都是可扩展的
mysql也是一个单独的服务，也可扩展


可解决多进程之间的数据同步问题

###为什么 session适合用 redis

1. session访问频繁， 对性能要求极高 （前置操作）
2. session可不考虑断电丢失数据的问题 （）
3. session数据量不会很大（相比于 在 mysql中存储的数据）

##为何网站数据不适合用redis？

1. 操作频率不太高
2. 断电不能丢失， 必须保留 （放在redis中有丢失风险）
3. 数据量太大，内存成本太高